---
import { formatDate } from '../lib/format';
import type { PostCardData, WritingCardData } from '../lib/sanity.types';
import SanityImage from './SanityImage.astro';
import TagList from './TagList.astro';

interface Props {
  post: PostCardData | WritingCardData;
  hrefPrefix?: string;
  showHeroImage?: boolean;
  showTags?: boolean;
}

const { post, hrefPrefix = '/posts', showHeroImage = true, showTags = true } = Astro.props;
const href = `${hrefPrefix}/${post.slug}`;
---

<article class:list={['post-card', { 'post-card-no-image': !showHeroImage }]}>
  {showHeroImage && (
    <a class="post-card-image-wrap" href={href}>
      <SanityImage
        image={post.heroImage}
        alt={post.heroImage?.alt ?? post.title}
        class="post-card-image"
        sizes="(max-width: 980px) 92vw, 520px"
      />
    </a>
  )}

  <div class="post-card-content">
    <p class="post-card-meta">
      <span>{formatDate(post.publishedAt)}</span>
    </p>

    <h3 class="post-card-title">
      <a href={href}>{post.title}</a>
    </h3>

    <p class="post-card-excerpt">{post.excerpt}</p>

    {showTags && <TagList tags={post.tags} hrefBase={hrefPrefix} />}
  </div>
</article>
